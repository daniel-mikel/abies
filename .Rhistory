select(-c(trash))
}
clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
print(small)
}
clean_sec2(sec2)
clean_sec2(sec2)
clean_grape_vector <- function(input){
input <- str_to_lower(input)
input <- str_replace_all(input, "[[:punct:]]", "")
input <- str_trim(input)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
print(small)
}
clean_sec2(sec2)
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
print(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
print(input)
input$Variety <- clean_grape_vector(as.character(input$Variety))
print(input)
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
print(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
print(input)
input$Variety <- clean_grape_vector(as.character(input$Variety))
print(input)
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
names(small)
print(small)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
select(-c(trash))
names(small)
print(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
names(small)
print(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
names(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
names(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
return(small)
}
new <- clean_sec2(sec2)
new
small[2]
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
for(i in 1:19){
small[i+1] <- as.character(small[i+1])
small[i+1] <- gsub(",", "", small[i+1])
small[i+1] <- as.numeric(small[i+1])
}
return(small)
}
new <- clean_sec2(sec2)
small[[2]]
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
new
str(new)
sum(new[2:18])
new$calc <- sum(new[2:18])
new$calc
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
small$calc <- small$'1' + small$`2` + small$`3` + small$`4` + small$`5` +
small$`6` + small$`7` + small$`8` + small$`9` + small$`10` +small$'11' +
small$`12` +small$`13` +small$`14` + small$`15` + small$`16` + small$`17`
small$diff <- small$total_current - small$calc
return(small)
}
new <- clean_sec2(sec2)
new
unique(small$diff)
unique(new$diff)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-c(trash, total_current, total_previous))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-c("trash", "total_current", "total_previous"))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash, -total_current, -total_previous))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash, -total_current, -total_previous))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash, -total_current, -total_previous))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(Variety, 1:17, Type))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash) %>%
select(-total_current) %>%
select(-total_previous)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
small <- small[1:11, 12:18]
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
small <- small[c(1:11, 12:18)]
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
small <- small[,c(1:11, 12:18)]
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
small <- as.data.frame(small[,c(1:11, 12:18)])
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
?select
clean_grape_vector <- function(input){
input <- str_to_lower(input)
input <- str_replace_all(input, "[[:punct:]]", "")
input <- str_trim(input)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(Variety, print(1:17))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
clean_grape_vector <- function(input){
input <- str_to_lower(input)
input <- str_replace_all(input, "[[:punct:]]", "")
input <- str_trim(input)
}
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(Variety, print(1:17))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
print(1:17)
class(names(new))
class(print(1:17))
class(paste(1:17))
paste(1:17)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(Variety, Type, paste(1:17))
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
new
clean_sec2 <- function(input){
names(input) <- c("Variety", 1:10, "trash", 11:17, "total_current", "total_previous")
input$Variety <- clean_grape_vector(as.character(input$Variety))
small <- input %>%
inner_join(grape.dict) %>%
select(-trash)
for(i in 1:19){
small[[i+1]] <- as.character(small[[i+1]])
small[[i+1]] <- gsub(",", "", small[[i+1]])
small[[i+1]] <- as.numeric(small[[i+1]])
}
return(small)
}
new <- clean_sec2(sec2)
new
msleep
msleep
long <- cleaned %>%
gather(district, tons, -c(Variety))
cleaned <- clean_sec2(sec2)
long <- cleaned %>%
gather(district, tons, -c(Variety))
long
write.csv(long, "/home/dan/Data/NASS/Grape_Crush/all_section_2/clean_csv/sec2_clean_2016.csv", row.names = FALSE)
long <- cleaned %>%
gather(District_Number, tons, -c(Variety))
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarize(Tons = sum(tons))
str(long)
long$tons <- as.character(long$tons)
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarize(Tons = sum(tons))
long$tons <- as.numeric(long$tons)
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarize(Tons = sum(tons))
long
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarize(Tons = sum(tons))
sec_2_totals
long$District_Number <- as.factor(long$District_Number)
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarize(Tons = sum(tons))
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarise(Tons = sum(tons))
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number)
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarise(Tons = sum(tons))
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarise(Tons = sum(tons, na.rm - TRUE))
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarise(Tons = sum(tons, na.rm = TRUE))
sec_2_totals
sec_2_totals <- long %>%
group_by(District_Number) %>%
summarise(Tons = sum(tons, na.rm = TRUE))
sec_2_totals
sec_2_totals <- long %>%
group_by(Variety) %>%
summarise(Tons = sum(tons, na.rm = TRUE))
sec_2_totals
names(cleaned)
cleaned[1:18]
cleaned <- cleaned[1:18]
long <- cleaned %>%
gather(District_Number, tons, -c(Variety))
write.csv(long, "/home/dan/Data/NASS/Grape_Crush/all_section_2/clean_csv/sec2_clean_2016.csv", row.names = FALSE)
long$tons <- as.numeric(long$tons)
long$District_Number <- as.factor(long$District_Number)
sec_2_totals <- long %>%
group_by(Variety) %>%
summarise(Tons = sum(tons, na.rm = TRUE))
sec_2_totals
sec_2_totals <- long %>%
group_by(as.factor(District_Number)) %>%
summarise(Tons = sum(tons, na.rm = TRUE))
sec_2_totals
long
str(long)
