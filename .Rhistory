gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5:7, 9:14, 16:17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5, 7:14, 16:17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5, 7:9, 11:14, 16:17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(8, 16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(8, 16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
gc %>%
)
gc %>%
filter(Type %in% c("red", "white")) %>%
spread(Type, Average_Price) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price)
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(6, 10, 15)
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(6, 10, 15) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(6, 10, 15)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(6, 10, 15)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5, 7, 9, 11:14)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(8, 16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5, 7, 9, 11:14)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(8, 16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(5, 7:9, 11:14)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
gc %>%
group_by(District_Disc, District_Number, Year, Type) %>%
filter(Type %in% c("red", "white")) %>%
summarize(Average_Price = sum(Base.Price.Per.Ton * Tons)/sum(Tons))  %>%
spread(Type, Average_Price) %>%
filter(District_Number %in% c(1:4, 16, 17)) %>%
ggplot(aes(x = red, y = white, color = District_Number)) +
geom_point() +
# geom_text(aes(label = Year), hjust = 1, vjust = 1.5) +
geom_smooth(method = lm, se = FALSE, linetype = 2) +
theme_minimal()
blogdown:::serve_site()
gc %>%
filter(Year == 2016,
Variety == "Primitivo") %>%
group_by(District_Disc, District_Number, Type) %>%
summarise(Thousand_Tons = sum(Tons)/1000) %>%
arrange(District_Number) %>%
ggplot(aes(x = as.factor(District_Number), y = Thousand_Tons, fill = Type)) +
geom_col() +
scale_fill_manual(values = cols) +
xlab(NULL) +
ylab("Thousand Tons Sold") +
scale_x_discrete(labels = c("1" = "[1] Mendocino",
"2" = "[2] Lake",
"3" = "[3] Sonoma",
"4" = "[4] Napa",
"5" = "[5] Solano",
"6" = "[6] North Central Coast",
"7" = "[7] Monterey and San Benito",
"8" = "[8] San Luis Obispo",
"9" = "[9] Northern California",
"10" = "[10] Sierra Foothills",
"11" = "[11] San Joaquin and Sacramento",
"12" = "[12] San Joaquin, Stanislaus, Merced",
"13" = "[13] Fresno, Madera, N. Tulare, Mono, Inyo",
"14" = "[14] Kern, Kings, S. Tulare",
"15" = "[15] L.A. and San Bernardino",
"16" = "[16] So Cal",
"17" = "[17] Yolo")) +
ggtitle("Grape Production in Tons by District") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 30, hjust = 1))
str(gc)
gc %>%
filter(Variety == "Primitivo") %>%
group_by(District_Disc, District_Number, Type) %>%
summarise(Thousand_Tons = sum(Tons)/1000) %>%
arrange(District_Number) %>%
ggplot(aes(x = as.factor(District_Number), y = Thousand_Tons, fill = Type)) +
geom_col() +
scale_fill_manual(values = cols) +
xlab(NULL) +
ylab("Thousand Tons Sold") +
scale_x_discrete(labels = c("1" = "[1] Mendocino",
"2" = "[2] Lake",
"3" = "[3] Sonoma",
"4" = "[4] Napa",
"5" = "[5] Solano",
"6" = "[6] North Central Coast",
"7" = "[7] Monterey and San Benito",
"8" = "[8] San Luis Obispo",
"9" = "[9] Northern California",
"10" = "[10] Sierra Foothills",
"11" = "[11] San Joaquin and Sacramento",
"12" = "[12] San Joaquin, Stanislaus, Merced",
"13" = "[13] Fresno, Madera, N. Tulare, Mono, Inyo",
"14" = "[14] Kern, Kings, S. Tulare",
"15" = "[15] L.A. and San Bernardino",
"16" = "[16] So Cal",
"17" = "[17] Yolo")) +
ggtitle("Grape Production in Tons by District") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 30, hjust = 1))
unique(gc$Variety)
gc %>%
filter(Year == 2016,
Variety == "primitivo") %>%
group_by(District_Disc, District_Number, Type) %>%
summarise(Thousand_Tons = sum(Tons)/1000) %>%
arrange(District_Number) %>%
ggplot(aes(x = as.factor(District_Number), y = Thousand_Tons, fill = Type)) +
geom_col() +
scale_fill_manual(values = cols) +
xlab(NULL) +
ylab("Thousand Tons Sold") +
scale_x_discrete(labels = c("1" = "[1] Mendocino",
"2" = "[2] Lake",
"3" = "[3] Sonoma",
"4" = "[4] Napa",
"5" = "[5] Solano",
"6" = "[6] North Central Coast",
"7" = "[7] Monterey and San Benito",
"8" = "[8] San Luis Obispo",
"9" = "[9] Northern California",
"10" = "[10] Sierra Foothills",
"11" = "[11] San Joaquin and Sacramento",
"12" = "[12] San Joaquin, Stanislaus, Merced",
"13" = "[13] Fresno, Madera, N. Tulare, Mono, Inyo",
"14" = "[14] Kern, Kings, S. Tulare",
"15" = "[15] L.A. and San Bernardino",
"16" = "[16] So Cal",
"17" = "[17] Yolo")) +
ggtitle("Grape Production in Tons by District") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 30, hjust = 1))
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown::new_site(theme = 'kakawait/hugo-tranquilpeak-theme.git')
blogdown::new_site(theme = 'kakawait/hugo-tranquilpeak-theme')
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size=8),
axis.text.y = element_text(hjust = 0.8)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
library(ggridges)
library(ggjoy)
library(tidyverse)
library(knitr)
gc <- read.csv("/home/dan/Data/NASS/Grape_Crush/gc_csv/all_gc_clean.csv")
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size=8),
axis.text.y = element_text(hjust = 0.8)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
?element_text()
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, hjust = 0.5)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, angle = 45)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, angle = 75)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, angle = 15)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, angle = 20)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
gc %>%
filter(Base.Price.Per.Ton <= 10000) %>%
arrange(desc(District_Number)) %>%
mutate(label = factor(District_Disc, unique(District_Disc))) %>%
ggplot(aes(x = Base.Price.Per.Ton, y = label, fill = label)) +
geom_joy(rel_min_height = 0.005, scale = 2,alpha = 0.5) +
# scale_x_continuous(breaks = c(0,5000, 10000, 15000)) +
scale_y_discrete(expand = c(0.01, 0)) +
scale_fill_cyclical(values = c("#66c2a5",
"#fc8d62",
"#8da0cb",
"#e78ac3",
"#a6d854",
"#ffd92f",
"#e5c494")) +
ggtitle("Histograms of Grape Prices by District") +
theme_joy() +
theme(axis.text = element_text(size = 10),
axis.text.y = element_text(size = 8, angle = 0)) +
xlab("Price, Dollars per Ton") +
ylab(NULL)
shiny::runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
str(gc)
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
gc %>%
filter(Year == input$Year,
Variety == input$variety) %>%
group_by(District_Disc, District_Number, Type) %>%
summarise(Tons = sum(Tons),
Value = sum(Tons * Base.Price.Per.Ton)) %>%
arrange(District_Number)
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
library(scales)
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
runApp('~/R/projects/grape_crush/shiny/gc_shiny_find_varieties')
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
blogdown:::serve_site()
